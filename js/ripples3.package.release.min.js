/**
 * Nico Pr â€” https://nicopr.fr
 * RIPPLES3 PACKAGE RELEASE v0.0.2
 * 01/02/2025 01:59:20
 */
(function(){const n={"default":{da:.997,Z:.995,O:8,wa:.8,Ea:new Float32Array([.04,.06,.11]),Ca:.02,Aa:.56,xa:.16,ub:.58,qa:.8,ra:.35,Ia:39,va:.6,ta:0,ua:6,za:new Float32Array([.78,.89,1]),tb:.62,oa:.12,ia:.27,pa:.08,J:.023,$:.42,K:.1,W:.2,na:.25,la:1,ma:.15,ja:.5,ka:3,T:new Float32Array([.35,.65,.45]),P:new Float32Array([-.45,.55,.45]),Ba:5,ya:2,Fa:.2,sa:.16,Da:.05},clear:{da:.997,Z:.994,O:12,wa:.6,Ea:new Float32Array([.01,.02,.03]),Ca:.008,Aa:.02,xa:.89,qa:2.9,ra:.3,Ia:25,va:1.1,ta:0,ua:5,za:new Float32Array([.88,
.96,1]),oa:.1,ia:.15,pa:.07,na:.3,la:.5,ma:.1,ja:.75,ka:2,T:new Float32Array([.45,.85,.5]),P:new Float32Array([-.25,.75,.4]),Ba:9,ya:12,V:.9,U:.22,S:.62,R:.18,Fa:.5,sa:.52,Da:.6,J:.023,$:.57,K:3.2,W:2.5},thick:{da:.99,Z:.988,O:3.5,wa:.4,Ea:new Float32Array([.05,.07,.12]),Ca:.045,Aa:.42,xa:.32,T:new Float32Array([.32,.58,.42]),P:new Float32Array([-.38,.52,.42]),Ba:12,ya:19,V:.18,U:.12,S:.68,R:.32,qa:.85,ra:1.8,Ia:42,va:2.3,ta:0,ua:.48,za:new Float32Array([.72,.82,.92]),oa:.15,ia:.2,pa:.35,na:.25,la:.85,
ma:.08,ja:.65,ka:2.8,Fa:.45,sa:.48,Da:.1,J:.039,$:.65,K:2.3,W:2.8},storm:{da:.998,Z:.995,O:13,wa:.62,Ea:new Float32Array([.07,.09,.13]),Ca:.035,Aa:.07,xa:.42,T:new Float32Array([.28,.48,.42]),P:new Float32Array([-.32,.42,.42]),Ba:.6,ya:2.4,V:.1,U:.45,S:.19,R:.48,qa:1.8,ra:4.5,Ia:52,va:3.5,ta:.15,ua:.55,za:new Float32Array([.65,.75,.85]),oa:.3,ia:.85,pa:.28,na:.45,la:.3,ma:.22,ja:.35,ka:4.5,Fa:.13,sa:1.15,Da:.35,J:.032,$:.93,K:3.3,W:3.6}};function r(a){var b=6*a;a=Math.floor(b);b-=a;const c=1-b;let d,e,f;switch(a%6){case 0:d=1;e=b;f=0;break;case 1:d=c;e=1;f=0;break;case 2:d=0;e=1;f=b;break;case 3:d=0;e=c;f=1;break;case 4:d=b;e=0;f=1;break;case 5:d=1,e=0,f=c}return new Float32Array([d,e,f])}function v(a,b){a=a*Math.PI*2;b*=Math.PI;return new Float32Array([Math.sin(b)*Math.cos(a),Math.cos(b),Math.sin(b)*Math.sin(a)])}
function w(a,b){var c=Object.keys(n);b=a.M+b;var d=c.length-1;a.M=0>b?d:b>d?0:b;c=c[a.M];a.D.innerText=c;c=n[c];x(a,c);a.h.load(c)}
function y(a){const b=Object.entries(a.h.i).map(([c,d])=>Object.hasOwn(a.i,c)?"sunDirection"===c||"secondarySunDirection"===c?null:d instanceof Float32Array?a.i[c].l+"="+JSON.stringify(Array.from(d)):a.i[c].l+"="+JSON.stringify(d):null).filter(Boolean);a.i.V&&a.i.U&&(b.push(`sth=${a.i.V.j}`),b.push(`sph=${a.i.U.j}`));a.i.S&&a.i.R&&(b.push(`lth=${a.i.S.j}`),b.push(`lph=${a.i.R.j}`));navigator.clipboard.writeText(location.origin+location.pathname+"#"+b.join("&")).then(()=>{}).catch(c=>{console.error(c)})}
function z(a,b){let c=document.createElement("span");c.tabIndex=0;c.classList.add("action",b.g.replaceAll(" ","-"));c.innerHTML=b.g;a.H.appendChild(c);c.addEventListener("click",()=>{b.B();c.focus()})}function A(a,b){let c=document.createElement("span");c.classList.add("toggle",b.g.replaceAll(" ","-"));b.Gb&&c.classList.add("toggled");c.innerHTML=b.g;a.H.appendChild(c);c.addEventListener("click",()=>{b.B()})}
function B(a,b){let c=document.createElement("div");c.classList.add("prop",b.g.replaceAll(" ","-"));c.addEventListener("pointerdown",e=>{e.preventDefault();let f=e.pointerId;a.A.has(f)||(Object.keys(a.G).forEach(k=>{c.addEventListener(k,a.G[k])}),c.setPointerCapture(f),a.A.set(f,b.g),a.I.set(f,e.pageX),c.classList.add("down"))});var d=document.createElement("div");d.classList.add("valt");d.innerHTML=b.g;c.appendChild(d);d=document.createElement("div");d.classList.add("val");d.innerHTML=b.j;c.appendChild(d);
b.nb=d;b.m?(d=b.m.toLowerCase().replaceAll(" ","-"),(d=a.s.querySelector("."+d))||(d=C(a,b.m)),d.querySelector(".cnt").appendChild(c)):a.s.appendChild(c);a.N.set(b.g,b)}function D(a){const b=a.s.getBoundingClientRect();a.gb={x:Math.round(b.x),y:Math.round(b.y),w:Math.round(b.width),v:Math.round(b.height)}}function E(a){a.C.addEventListener("transitionend",()=>{},{once:!0});a.C.classList.add("up")}
function x(a,b){Array.from(a.N.values()).forEach(c=>{Object.hasOwn(b,c.key)&&(c.j=b[c.key],c.nb.innerText=b[c.key])});b.V&&b.U&&(b.T=v(b.V,b.U));b.S&&b.R&&(b.P=v(b.S,b.R))}
function F(a){const b=window.location.hash.slice(1);if(b.length)try{const k={};var c,d,e,f;b.split("&").map(g=>g.split("=")).forEach(([g,h])=>{const l=Object.keys(a.i).find(p=>a.i[p].l===g);l&&(h=JSON.parse(h),k[l]=Array.isArray(h)?new Float32Array(h):h,"sth"===g&&(c=h),"sph"===g&&(d=h),"lth"===g&&(e=h),"lph"===g&&(f=h))});void 0!==c&&void 0!==d&&(k.T=v(c,d));void 0!==e&&void 0!==f&&(k.P=v(e,f));a.D.innerText="custom";x(a,k);return k}catch(k){console.log("parse params error"),console.error(k)}return{}}
function G(a,b){b.classList.contains("exp")?b.classList.remove("exp"):Array.from(a.s.querySelectorAll(".group")).forEach(c=>c.classList.toggle("exp",c===b))}
function C(a,b){let c=document.createElement("div");c.classList.add("group",b.toLowerCase().replaceAll(" ","-"));a.s.appendChild(c);let d=document.createElement("div");d.classList.add("grp");d.innerHTML=b;c.appendChild(d);b=document.createElement("div");b.classList.add("wrp");c.appendChild(b);let e=document.createElement("div");e.classList.add("cnt");b.appendChild(e);d.addEventListener("click",()=>G(a,c));return c}
class H{constructor(a){this.h=a;this.pop=!1;this.M=0;this.gb={x:0,y:0,w:0,v:0};this.i={da:{g:"wave speed",l:"wsp",j:.997,min:.95,max:.999,o:.001,m:"global",exp:"Controls how quickly waves propagate. Higher values = faster waves"},Z:{g:"damping",l:"dmp",j:.994,min:.9,max:.999,o:.001,m:"global",exp:"How quickly waves lose energy. Higher values = waves persist longer"},O:{g:"propagation",l:"pgs",j:12,min:2,max:16,o:2,Cb:!0,m:"global",exp:"Distance waves travel per frame. Higher = faster spread"},wa:{g:"refraction",
l:"rft",j:.8,min:0,max:5,o:.01,m:"visual",exp:"Light bending through water. Higher values = more distortion"},ub:{g:"water hue",l:"wth",j:.58,min:0,max:1,o:.01,m:"visual",exp:"Base color of water (0-1 maps to color wheel)",B:b=>{this.h.i.Ea=r(b)}},Ca:{g:"tint",l:"tnt",j:.02,min:0,max:.3,o:.005,m:"visual",exp:"Intensity of water coloration"},Aa:{g:"specular strength",l:"sps",j:.56,min:0,max:5,o:.01,m:"visual",exp:"Intensity of light reflections on water surface"},xa:{g:"roughness",l:"rgs",j:.16,min:0,
max:1,o:.01,m:"visual",exp:"Surface texture. Higher = more diffuse reflections"},qa:{g:"effect",l:"fre",j:.8,min:0,max:30,o:.1,m:"fresnel",exp:"Edge brightness. Higher = stronger edge highlights"},ra:{g:"power",l:"frp",j:2.6,min:.1,max:1,o:.005,m:"fresnel",exp:"Sharpness of edge effect. Higher = more concentrated"},va:{g:"reflection",l:"frr",j:1,min:0,max:5,o:.05,m:"fresnel",exp:"Strength of angle-based reflections"},ta:{g:"blur",l:"blr",j:0,min:0,max:5,o:.01,m:"fresnel",exp:"Softness of reflections"},
ua:{g:"distortion",l:"dst",j:.3,min:0,max:30,o:.1,m:"fresnel",exp:"Wave-based reflection warping"},tb:{g:"sky hue",l:"skh",j:.62,min:0,max:3,o:.01,m:"world",exp:"Color of environmental reflection (0-1 maps to color wheel)",B:b=>{this.h.i.za=r(b)}},oa:{g:"depth",l:"dpt",j:4,min:0,max:10,o:.01,m:"world",exp:"Simulated water depth effect"},ia:{g:"scatter",l:"sct",j:.72,min:0,max:1,o:.01,m:"world",exp:"Atmospheric light scattering in water"},pa:{g:"environment",l:"env",j:.5,min:0,max:5,o:.01,m:"world",
exp:"Strength of environmental reflections"},J:{g:"radius",l:"trd",j:.017,min:.005,max:.1,o:.001,m:"touch",exp:"Size of interaction area"},$:{g:"impact",l:"tmp",j:0,min:.01,max:2,o:.01,m:"touch",exp:"Initial strength of touch disturbance"},K:{g:"trail",l:"ttr",j:0,min:0,max:5,o:.05,m:"touch",exp:"Strength of continuous touch effect"},W:{g:"spread",l:"tsp",j:3.2,min:0,max:5,o:.05,m:"touch",exp:"How widely touch effect spreads"},na:{g:"strength",l:"css",j:.25,min:0,max:1,o:.01,m:"caustic",exp:"Intensity of underwater light patterns"},
la:{g:"scale",l:"csc",j:1,min:.5,max:3,o:.1,m:"caustic",exp:"Size of caustic patterns"},ma:{g:"speed",l:"csp",j:.15,min:0,max:2,o:.01,m:"caustic",exp:"Animation speed of caustics"},ja:{g:"brightness",l:"csb",j:.5,min:0,max:2,o:.01,m:"caustic",exp:"Overall brightness of caustic effects"},ka:{g:"detail",l:"csd",j:2,min:0,max:5,o:.05,m:"caustic",exp:"Complexity of caustic patterns"},Ba:{g:"sun",l:"sun",j:.3,min:0,max:50,o:.1,m:"sunlight",exp:"Primary light source intensity"},V:{g:"sun angle",l:"sth",
j:.1,min:0,max:1,o:.01,m:"sunlight",exp:"Horizontal angle of sun (0-1 = 0-360\u00b0)",B:()=>{this.h.i.T=v(this.i.V,this.i.U)}},U:{g:"sun height",l:"sph",j:.35,min:0,max:1,o:.01,m:"sunlight",exp:"Vertical angle of sun (0 = up, 1 = down)",B:()=>{this.h.i.T=v(this.i.V,this.i.U)}},ya:{g:"light",l:"lht",j:.16,min:0,max:50,o:.1,m:"sunlight",exp:"Secondary light source intensity"},S:{g:"light angle",l:"lth",j:.65,min:0,max:1,o:.01,m:"sunlight",exp:"Horizontal angle of secondary light",B:()=>{this.h.i.P=
v(this.i.S,this.i.R)}},R:{g:"light height",l:"lph",j:.3,min:0,max:1,o:.01,m:"sunlight",exp:"Vertical angle of secondary light",B:()=>{this.h.i.P=v(this.i.S,this.i.R)}},Fa:{g:"waves",l:"rfs",j:.5,min:0,max:5,o:.01,m:"reflect",exp:"Strength of wave-based reflections"},sa:{g:"mirror",l:"rfm",j:.16,min:0,max:15,o:.05,m:"reflect",exp:"Strength of mirror-like reflections"},Da:{g:"velocity",l:"rfv",j:.05,min:0,max:10,o:.05,m:"reflect",exp:"How much wave motion affects reflections"}};this.ea=document.createElement("div");
this.ea.classList.add("params");document.body.appendChild(this.ea);this.C=document.createElement("div");this.C.classList.add("gear");this.ea.appendChild(this.C);this.s=document.createElement("div");this.s.classList.add("pwrp");this.ea.appendChild(this.s);this.H=document.createElement("div");this.H.classList.add("switch");this.s.appendChild(this.H);this.F=document.createElement("div");this.F.classList.add("preset");this.s.appendChild(this.F);a=document.createElement("div");a.classList.add("preprev");
a.innerText="<";this.F.appendChild(a);a.addEventListener("click",()=>w(this,-1));this.D=document.createElement("div");this.D.classList.add("prename");this.D.innerText="default";this.F.appendChild(this.D);a=document.createElement("div");a.classList.add("prenext");a.innerHTML=">";this.F.appendChild(a);a.addEventListener("click",()=>w(this,1));this.X={close:{g:"about",L:"cmd",B:()=>{window.location="https://post.nicopr.fr/liquid-code/"}},toggle:{g:"flow",L:"swp",B:()=>{var b=this.h;b.X?I(b):b.bb()},
Gb:!0},reset:{g:"reset",L:"cmd",B:()=>J(this.h)},Wb:{g:"upscl",L:"cmd",B:()=>{var b=this.h;K(b,b.u+.5)}},Tb:{g:"copy",L:"cmd",B:()=>y(this)},Rb:{g:"&nbsp;".repeat(5),L:"cmd",B:()=>{}},Sb:{g:"point",L:"swp",B:()=>{var b=this.h;b.G?b.G&&(b.G=!1,b.C.toggle("point",b.G)):L(b)}},Ub:{g:"rain",L:"swp",B:()=>{var b=this.h;b.Na?(b.Na=!1,b.C.toggle("rain",!1)):(b.Na=!0,b.ab=0,b.Ja=new Set,M(b),b.C.toggle("rain"))}},Vb:{g:"swirl",L:"cmd",B:()=>{var b=this.h;for(let c=0;3>c;c++)N(b,b.w/2,b.v/2,.3*Math.min(b.w,
b.v),2*Math.PI/3*c,b.Pb)}}};this.A=new Map;this.I=new Map;this.N=new Map;this.ha=this.ga.bind(this);this.Y=this.fa.bind(this);this.G={pointermove:this.ha,pointerup:this.Y,pointerleave:this.Y};Object.keys(this.X).forEach(b=>{b=this.X[b];"cmd"===b.L?z(this,b):"swp"===b.L&&A(this,b)});Object.keys(this.i).forEach(b=>{const c=this.i[b];c.key=b;c.j=this.h.i[b]||c.j;c.B=d=>{this.h.i[b]=d};B(this,c)});this.C.addEventListener("click",()=>{this.ea.classList.toggle("pop");this.pop=this.ea.classList.contains("pop")});
this.ea.addEventListener("transitionend",()=>D(this))}toggle(a,b=!0){this.s.querySelector("."+a).classList.toggle("toggled",b)}ga(a){a.preventDefault();let b=a.pointerId;if(this.A.has(b)){let e=Math.round((a.pageX-this.I.get(b))/3);if(0!=e){var c=this.A.get(b);c=this.N.get(c);var d=String(c.o).match(/\.(\d+)$/);d=Math.pow(10,d?d[1].length:0);c.j=Math.round(Math.min(Math.max(c.min,c.j+e*c.o),c.max)*d)/d;this.I.set(b,a.pageX);c.Cb&&(J(this.h),this.h.Ua());c.B(c.j);a=String(c.o).match(/\.(\d+)$/);c.nb.innerHTML=
c.j.toFixed(a?a[1].length:0)}}}fa(a){a.preventDefault();a=a.pointerId;if(this.A.has(a)){let b=this.A.get(a),c=document.querySelector(".params ."+b.replaceAll(" ","-"));c.releasePointerCapture(a);Object.keys(this.G).forEach(d=>{c.removeEventListener(d,this.G[d])});c.classList.remove("down");this.A.delete(a);this.I.delete(a)}}};window.addEventListener("load",()=>{try{var a=new O;const b=new H(a),c=F(b);P(a,b,c).then(()=>{})}catch(b){console.error(b),a=document.createElement("div"),a.classList.add("err"),a.innerHTML="<div>liquify fail</div><br/>"+b,document.body.appendChild(a)}});
function J(a,b="reset"){Q(a,b);const c=a.h,d=new Float32Array(a.w*a.v*4);for(b=0;b<d.length;b+=4)d[b]=0,d[b+1]=0,d[b+2]=0,d[b+3]=1;[a.D,a.F].forEach(e=>{c.bindTexture(c.TEXTURE_2D,e);c.texImage2D(c.TEXTURE_2D,0,c.RGBA32F,a.w,a.v,0,c.RGBA,c.FLOAT,d)});a.M=a.I;a.N=a.D;a.H=a.F}
function P(a,b=null,c={}){a.C=b;a.i={...a.i,...c};a.Ma=document.querySelector("#fps");return[a.Lb,a.Mb,a.Kb,a.Ab,a.Hb,a.zb,a.qb,a.sb,a.Db,a.rb,a.Ua,a.Ob,a.bb].map(d=>d.bind(a)).reduce((d,e)=>d.then(()=>e()),Promise.resolve()).then(()=>new Promise(d=>{a.A.addEventListener("transitionend",()=>{E(a.C);d()},{once:!0});a.A.style.opacity=1})).catch(d=>{console.log("liquify fail");throw d;})}function R(a){a.Sa=window.innerWidth;a.Ra=window.innerHeight;a.Ta=Math.max(a.Sa,a.Ra)/1024}
function S(a){return new Promise((b,c)=>{const d=new Image;d.addEventListener("load",()=>b(d));d.addEventListener("error",()=>c());d.crossOrigin="Anonymous";d.src=a})}async function T(a){return await (new Response((new Response(Uint8Array.from(atob(a),b=>b.charCodeAt(0)))).body.pipeThrough(new DecompressionStream("gzip")))).text()}
function U(a){const b=a.h,c=b.createTexture();b.bindTexture(b.TEXTURE_2D,c);b.texImage2D(b.TEXTURE_2D,0,b.RGBA32F,a.w,a.v,0,b.RGBA,b.FLOAT,null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);a=b.getError();if(a!==b.NO_ERROR)throw console.error(a),Error("create water texture fail");return c}
function aa(a){const b=a.h;[a.D,a.F].forEach(c=>{b.bindTexture(b.TEXTURE_2D,c);b.texImage2D(b.TEXTURE_2D,0,b.RGBA32F,a.w,a.v,0,b.RGBA,b.FLOAT,null)});[a.I,a.Ya].forEach(c=>{b.bindFramebuffer(b.FRAMEBUFFER,c);if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw Error("incomplete resized framebuffer");});b.bindFramebuffer(b.FRAMEBUFFER,null)}
function ba(a){if(a.image?.complete&&a.image.naturalWidth){var b=a.h,c=document.createElement("canvas"),d=c.getContext("2d",{alpha:!1});c.width=a.w;c.height=a.v;d.fillStyle="#000000";d.fillRect(0,0,a.w,a.v);var e=a.image.naturalWidth,f=a.image.naturalHeight,k=a.w/a.v;if(k>e/f){var g=e;var h=Math.round(e/k);e=0;f=Math.round((f-h)/2)}else h=f,g=Math.round(f*k),f=0,e=Math.round((e-g)/2);d.drawImage(a.image,e,f,g,h,0,0,a.w,a.v);a.ib.forEach(l=>{if(l.ob?.complete){const {x:p,y:t,w:m,v:u}=l.c();d.globalAlpha=
.55;d.shadowColor="#000000";d.shadowBlur=16;d.drawImage(l.ob,p,t,m,u)}});b.bindTexture(b.TEXTURE_2D,a.Ga);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,c);d.clearRect(0,0,a.w,a.v);c.width=c.height=0;c=null}}function ca(a){clearTimeout(a.pb);a.pb=setTimeout(()=>{V(a);D(a.C)},256)}function V(a){R(a);a.qb();a.Ua();a.sb();a.rb()}
function da(a){const b=a.h,c=a.fa,d=a.i;b.uniform2f(c.eb,a.w,a.v);b.uniform1f(c.time,a.ha);b.uniform1f(c.u,a.u);Object.keys(d).filter(e=>c[e]&&d[e]instanceof Float32Array).forEach(e=>b.uniform3fv(c[e],d[e]));Object.keys(d).filter(e=>c[e]&&"number"===typeof d[e]).forEach(e=>b.uniform1f(c[e],d[e]))}function I(a){a.X&&(a.X=!1,cancelAnimationFrame(a.hb),a.Ma.textContent="x"+a.u.toString()+" --",a.C.toggle("flow",!1))}function Q(a,b="wait"){a.Ma.textContent=b;a.lb=a.Oa+2500;a.Ka=0}
function W(a){a.hb=requestAnimationFrame(b=>{if(!a.h||a.h.isContextLost())console.error("webgl context lost"),I(a);else{a.Ha=a.vb/1E3*(2/a.u);a.ha+=a.Ha;var c=a.h,d=a.Va;c.useProgram(a.Y);c.bindFramebuffer(c.FRAMEBUFFER,a.M);c.bindBuffer(c.ARRAY_BUFFER,a.Qa);var e=c.getAttribLocation(a.Y,"position");c.enableVertexAttribArray(e);c.vertexAttribPointer(e,2,c.FLOAT,!1,0,0);c.uniform2f(d.eb,a.w,a.v);c.uniform1f(d.u,a.u);c.uniform1f(d.Ta,a.Ta);c.uniform1f(d.Ha,a.Ha);c.uniform1f(d.time,a.ha);c.uniform1f(d.da,
a.i.da);c.uniform1f(d.Z,a.i.Z);c.uniform1f(d.O,a.mb);e=Array.from(a.s.values());const f=Math.min(e.length,10);a.ca.fill(0);const k=a.h,g=a.Va;for(let h=0;h<f;h++){const l=e[h];a.ca[2*h]=l.x;a.ca[2*h+1]=l.y;a.ca[2*(h+f)]=l.aa;a.ca[2*(h+f)+1]=l.ba;k.uniform2f(g.touches[h].position,l.x,l.y);k.uniform1f(g.touches[h].Bb,l.J);k.uniform1f(g.touches[h].Fb,l.$);k.uniform1f(g.touches[h].Jb,l.K);k.uniform1f(g.touches[h].Eb,l.W)}k.uniform2fv(g.ca,a.ca);k.uniform1i(g.Ib,f);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,
a.H);c.uniform1i(d.cb,0);c.drawArrays(c.TRIANGLE_STRIP,0,4);[a.M,a.N,a.H]=[a.M===a.I?a.Ya:a.I,a.N===a.D?a.F:a.D,a.H===a.D?a.F:a.D];c=a.h;c.useProgram(a.Pa);c.bindFramebuffer(c.FRAMEBUFFER,null);c.clearColor(0,0,0,1);c.clear(c.COLOR_BUFFER_BIT);c.bindBuffer(c.ARRAY_BUFFER,a.Qa);d=c.getAttribLocation(a.Pa,"position");c.enableVertexAttribArray(d);c.vertexAttribPointer(d,2,c.FLOAT,!1,0,0);da(a);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,a.N);c.uniform1i(a.fa.Nb,0);c.activeTexture(c.TEXTURE1);
c.bindTexture(c.TEXTURE_2D,a.Ga);c.uniform1i(a.fa.Ga,1);c.activeTexture(c.TEXTURE2);c.bindTexture(c.TEXTURE_2D,a.H);c.uniform1i(a.fa.cb,2);c.drawArrays(c.TRIANGLE_STRIP,0,4);d=c.getError();d!==c.NO_ERROR&&console.error("render step error",d);d=c.checkFramebufferStatus(c.FRAMEBUFFER);d!==c.FRAMEBUFFER_COMPLETE&&console.error("incomplete framebuffer",d);ea(a,b);W(a)}})}
function ea(a,b){var c=b-a.Oa;a.Oa=b;b<=a.lb||(a.La[a.Xa]=c,a.Xa=(a.Xa+1)%a.La.length,c=a.La.reduce((d,e)=>d+e)/a.La.length,c=Math.round(1E3/c),c!==a.Ka&&(a.Ma.textContent="x"+a.u.toString()+" "+c.toString().padStart(2,"0")),a.Ka=c,1E3<=b-a.kb&&(a.kb=b,a.Wa++,3<=a.Wa&&(55>a.Ka?fa(a):a.u<a.fb&&a.u<a.ga&&K(a,a.u+.5))))}function fa(a){a.fb=a.u-.5;K(a,a.u-.5)}function K(a,b){b=Math.max(Math.min(a.ga,b),1);b!=a.u&&(a.Wa=0,Q(a,(b>a.u?"up":"down")+"scale"),a.u=Math.round(2*b)/2,V(a))}
function X(a,b){const c=b.clientX;b=b.clientY;return{x:c*a.u,y:a.v-b*a.u,rx:c,ry:b}}function Y(a){return{J:a.i.J,$:a.i.$,K:a.i.K,W:a.i.W}}function Z(a){if(a.C.pop){const b=Array.from(a.s.values()).some(c=>{var d=c.rx;c=c.ry;var e=a.C.gb;return d>=e.x&&d<=e.x+e.w&&c>=e.y&&c<=e.y+e.v});b!==a.$a&&(a.$a=b,clearTimeout(a.jb),a.jb=setTimeout(()=>{a.C.ea.classList.toggle("msk",a.$a)},100))}}
function N(a,b,c,d,e,f){const k=Math.random().toString(36).slice(-6),g=performance.now(),h=b+Math.cos(e)*d,l=c+Math.sin(e)*d,p={x:h,y:l,aa:h,ba:l,...Y(a),K:.08,W:.06,speed:2.2};a.s.set(k,p);const t=()=>{var m=performance.now()-g;if(1>m/3333){const u=e+.001*m*p.speed;m=f(m,0,1,3333);m=d*(1-m);if(a.s.has(k)){const q=a.s.get(k);q.aa=q.x;q.ba=q.y;q.x=b+Math.cos(u)*m;q.y=c+Math.sin(u)*m;requestAnimationFrame(t)}}else a.s.delete(k)};requestAnimationFrame(t)}
function M(a){if(a.Na){var b=performance.now();256<b-a.ab&&4>a.Ja.size&&8>a.s.size&&(ha(a),a.ab=b);requestAnimationFrame(()=>M(a))}}function ha(a){const b=Math.random()*a.w,c=Math.random()*a.v,d="rain_"+Math.random().toString(36).slice(-6);a.s.set(d+"_impact",{x:b,y:c,aa:b,ba:c,...Y(a),J:.01,K:.1});setTimeout(()=>{a.s.set(d+"_splash",{x:b,y:c,aa:b,ba:c,...Y(a),J:.04})},64);a.Ja.add(d);setTimeout(()=>{a.s.delete(d+"_impact");a.s.delete(d+"_splash");a.Ja.delete(d)},72)}
function L(a){if(!a.G){a.G=!0;var b=0,c={x:a.w/2,y:a.v/2,aa:a.w/2,ba:a.v/2,speed:.01,scale:.5,...Y(a)};a.s.set("auto",c);var d=()=>{a.G?(b+=c.speed,c.aa=c.x,c.ba=c.y,c.x=a.w*(.5+c.scale*Math.sin(b)),c.y=a.v*(.5+c.scale*Math.cos(1.5*b)),requestAnimationFrame(d)):a.s.delete("auto")};d();a.C.toggle("point")}}
class O{constructor(){this.u=this.ga=2;this.Wa=0;this.fb=this.ga;this.vb=1E3/60;this.Ta=this.Sa=this.Ra=0;R(this);this.i={da:.997,Z:.995,O:8,wa:.8,Ea:new Float32Array([.04,.06,.11]),Ca:.02,Aa:.56,xa:.16,ub:.58,qa:.8,ra:.35,Ia:39,va:.6,ta:0,ua:6,za:new Float32Array([.78,.89,1]),tb:.62,oa:.12,ia:.27,pa:.08,J:.023,$:.42,K:.1,W:.2,na:.25,la:1,ma:.15,ja:.5,ka:3,T:new Float32Array([.35,.65,.45]),P:new Float32Array([-.45,.55,.45]),Ba:5,ya:2,Fa:.2,sa:.16,Da:.05};this.C=this.jb=this.pb=this.image=this.A=this.h=
this.Qa=this.Y=this.Va=this.Pa=this.fa=this.N=this.H=this.Ga=this.D=this.F=this.M=this.I=this.Ya=null;this.hb=-1;this.$a=!1;this.Qb=new Float32Array([-1,-1,1,-1,-1,1,1,1]);this.ca=new Float32Array(20);this.mb=this.i.O;this.Ka=0;this.La=Array(30).fill(16.67);this.lb=this.kb=this.Oa=this.Xa=0;this.X=!1;this.isVisible=!0;this.Na=this.G=!1;this.ab=0;this.Ja=null;this.s=new Map;this.ha=this.Ha=0;this.ib=[];this.Ma=null;this.A=document.createElement("canvas");this.A.style.opacity=0;document.body.appendChild(this.A)}load(a){J(this,
"loading");this.i={...this.i,...a};this.Ua()}async Lb(){this.image=await S("assets/img.webp")}async Mb(){this.ib.push({ob:await S("assets/github-mark-white.png"),c:()=>({x:this.w-42*this.u,y:6*this.u,w:36*this.u,v:36*this.u})})}Kb(){this.h=this.A.getContext("webgl2",{alpha:!1,antialias:!1,depth:!1,stencil:!1,powerPreference:"high-performance",preserveDrawingBuffer:!1});if(!this.h)throw Error("WebGL2 not supported");if(!this.h.getExtension("EXT_color_buffer_float"))throw Error("EXT_color_buffer_float not supported");
this.h.getExtension("OES_texture_float_linear");const a=this.h.getError();a!==this.h.NO_ERROR&&console.error("WebGL error during initialization:",a)}async Ab(){const a=await T("H4sIAAAAAAAAClMuSy0qzszPUzA2MFBILebKzFMoS002UijIL84syczPs84vLYGIlKRWOOfnF6VYl+VnpijkJmbmaWhWwwRtYeq19Ey19Uyt03PiA6AitmWpySYaMHkdAx1DTetaAIBqaOZ3AAAA"),b=await T("H4sIAAAAAAAACoVUTW+bQBC991cgVYpYvMZgJ20qQg6Ne+vBiqP2EPmwgjGMBCzaD5c04r9XuyyE2JVyY2dn3rw385bPJxASeeNtosgD+akVkKENlFiUrXesOFPJeVSyuq1ArLeJbvDIRe2dIFt7+hEkr7RC3kwXFsDTW6gUe8IaqN6ibCv2ss9YBVTv8S98ZxKo/s1OsG8Bcqq3rG6xKajeCd6yghlEezXBTgw8vRNwQq7lXjEFZ4SeuM7K5zg6THFslAs/cN2oRCqhM+XZyKstarlEK2GgLliOWrqDVAKaQpXuqATDarxqBbA86adOFtL12jHBammJYDNwU9A9cC7yhGtlItfeUbDigVdcJCeOuVczbHzyaq+k0ZYq6JQW4L+XTEck4piUgEWpUlsTdskgCjuoUvPpx2Q1X5Rjr+s0CpMjF76ZEKZRgne3CS4W5HXIYE1RQWq/fSRB+PX2ZvPtNv6ySaSuFx9xW9jWGZe+xSFUYuM+SWDJBRfLJmGX9IZYjZ0/iKJS10EYr2+CdbgcBL7MnEOC0TpO1p+SKeOwtGadP1MddnR+eiFnyucOmc0gR6nSyjrAH5UFM6ClMxweyMr/qOVq8j6h0jyG/NFaLX1nGTyEzoF49E3/u3nuSAzrlmXqonK0ayBrzlUpFbT+vJxGITWYJAhvDP55vfX3fRReXeF9RNzzEHDa8ZHlMy7jA635CX5BNsUOS5fl1mDuf0Izjs6lk9W4HtPb5dzHsLx2rUxoiyJ1+auzcqr4jmOj0v+u4j0DVvGmeDJy0pwr31VS14EYAm8pd1E4DtZO4MfxCJlKoWv95bj9AWD5VhSMWJOq1cU8h3/EIoyimJBkWNriYmu2ZzDrHLjZBOEm6fvevrehOOn76a9hXve1L3VN3VuJaEyS/h+jh5Pl4gUAAA=="),
c=await T("H4sIAAAAAAAACpVWS3PbNhC+91dwphcAhGBRttp4EB5qK57mkE7GcpMzSoESJhTBgoBMJqP/3gHAB6hH655ILLmLb1/f7s8Hrmohy+h2Po94/VOleCacYCe2uyrKC8k0PZXWbF8VXC1W1JQil2ofHXi2iMwzr2VhtJDl8MEZiMyL2HNsVqKuCtauM1bw4Y/BWGS+Ms3V71xsdxqbB5Z92yppys0Lb7RRHJvPih+ENPVaM83Du28jszblSiie2duxWfNMlhum2lB8Cmptyo+l5mUtdBuoBLJnnis21fW3OaQvotTnjpZ6rRUvt3qHzbrimSmYGiXP0mx3Ja9rbJ4Ur0tefMhznunh+Fm+cjVqdsdnnhfeie63ULQStZbqAsr1t/ZRFlKdglzxSu+eWKalwuY3vZd1teNKZOuMaW2v+1AePrEqCMQjM7UW2ehHL7CpHE8V55vh9KBsIr2vnWjFNRMFNl/ZgY/4R6ufhFJSXfryhRcyE7oNAtHhHyUPhVFUlL4YNW8epVQbKo22krsoV2zrw+Gis+X6D6n2rAC+eA/YPSvR8AL+cBobplmqffWBaXUeIPXBLJ2NHmiakJj9VQOrSZqZe7QQLQhVXBtVdr+L79zeegvARetZwfYVMIeZRQQcItLgOcRzghMCIWlm/6oXX9WDaIoXTXoSvwXOHHvD7f+Ec0nvP+AkENKjS5YnCZtgxTdjxofU+VwothGmPs3jbZTZrKcu4PM+b1pqVqRzQnOpgCh11KSzhDbv04Q2cQx7aWulrZW2cezMLSKZ5zXX6dQ9ZxU00EMBLYTIw0EOSecz9bqkTRMy6987RK8uavZD4YLhnAMNbiG8WRDqnIjHcjznR28Pkqb9jrwx6ryM0+507IrQmbpx3+jRX77lehrW265UsXsvrP5KKH86CP5qD1710LUm/OHPdcWzldTpnjVgIzXo7IyV3xuLOzvQVgTsOgRU8hV0JvBi+QuB6I6gq8yAFiQONabEiUBCZiPnQoiA7c4BMUoWJCbvILrCSCghS4jOaNyajaeGrhIUuiO2iKXYRHsmStDVkCuK1GU4gTfh5AwjnJ7QxRzPXVM4dtq5pK6uclTPgH3F+//TUY00uHegk86Cjy0NqiAd2bI369sZ0t1QtrypAJglJPYiFM4ZiC4Mmh5Z5qdDOid44yaEa/90OjVQ0jWr1xFpQqh4ny4IFUNndobqP7+kPUw0GVVIxN4h0rTo8gj15j2OJ8X/TgNISNDuijitRQnG+0iDRpXY7TtoMhaRgOhEpX2DCkjIjYD02IeoeyKyjMnSZygXJSvcYEv3ogHXqNLTVR+WIAwgWHNOqpose7I+nbMXWmBJYFcTeNyP8GQj6iuDLCENM207OCGzE8bo6cGyw3Q/gmi6PdEgBt7PURC7zkkwuf8Vk/sFRFOqO2OnySYJexA4aPVwb/TWyf07TO7vcfIG65c208vXnC2ksc3vsNVh7xgMewai090NheV7vkdOowNRX1+nGx863+ocufqE9lVChx3LUttdkAWcQHr8BxvpwntuDAAA");
this.Y=this.createProgram(a,b);this.Pa=this.createProgram(a,c)}zb(){this.Qa=this.h.createBuffer();this.h.bindBuffer(this.h.ARRAY_BUFFER,this.Qa);this.h.bufferData(this.h.ARRAY_BUFFER,this.Qb,this.h.STATIC_DRAW)}qb(){const a=Math.round(this.Ra*this.u);this.A.width=Math.round(this.Sa*this.u);this.A.height=a;this.A.style.width=this.Sa+"px";this.A.style.height=this.Ra+"px"}sb(){this.h.viewport(0,0,this.w,this.v)}Ua(){this.mb=Math.round(this.i.O*this.u/2)}Db(){const a=this.h;this.D=U(this);this.F=U(this);
const b=this.h,c=b.createTexture();b.bindTexture(b.TEXTURE_2D,c);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,this.w,this.v,0,b.RGBA,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);this.Ga=c;this.I=this.createFramebuffer(this.D);this.Ya=this.createFramebuffer(this.F);this.M=this.I;this.N=this.D;
this.H=this.F;a.bindFramebuffer(a.FRAMEBUFFER,null);a.bindTexture(a.TEXTURE_2D,null)}createFramebuffer(a){const b=this.h,c=b.createFramebuffer();b.bindFramebuffer(b.FRAMEBUFFER,c);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,a,0);a=b.checkFramebufferStatus(b.FRAMEBUFFER);if(a!==b.FRAMEBUFFER_COMPLETE)throw console.error("framebuffer create fail",a),Error(`incomplete framebuffer ${a}`);return c}rb(){aa(this);ba(this)}Hb(){const a=(b,c)=>Object.keys(c).reduce((d,e)=>({...d,
[e]:this.h.getUniformLocation(b,`u${c[e]}`)}),{});this.Va={...a(this.Y,{eb:"Resolution",u:"DisplayScale",Ta:"SizeBase",Ha:"DeltaTime",time:"Time",da:"WaveSpeed",Z:"Damping",O:"PropagationSpeed",cb:"PreviousState",ca:"Touch",Ib:"TouchCount"}),touches:Array(10).fill({}).map((b,c)=>{b=`TouchParams[${c}].`;return a(this.Y,{position:`${b}position`,Bb:`${b}radius`,Fb:`${b}strength`,Jb:`${b}trail`,Eb:`${b}spread`})})};this.fa=a(this.Pa,{eb:"Resolution",time:"Time",u:"DisplayScale",cb:"PreviousState",Nb:"WaterHeight",
Ga:"BackgroundTexture",T:"SunDirection",P:"SecondarySunDirection",Ba:"SunIntensity",ya:"SecondaryIntensity",wa:"Refraction",Ea:"WaterTint",Ca:"TintStrength",Aa:"SpecularStrength",xa:"Roughness",qa:"FresnelEffect",ra:"FresnelPower",Ia:"SpecularPower",za:"SkyColor",oa:"DepthFactor",ia:"AtmosphericScatter",pa:"EnvMapIntensity",va:"ReflectionFresnel",ta:"ReflectionBlur",ua:"ReflectionDistortion",na:"CausticStrength",la:"CausticScale",ma:"CausticSpeed",ja:"CausticBrightness",ka:"CausticDetail",Fa:"WaveReflectionStrength",
sa:"MirrorReflectionStrength",Da:"VelocityReflectionFactor"})}createProgram(a,b){const c=this.h,d=c.createProgram(),e=(g,h)=>{g=c.createShader(g);c.shaderSource(g,h);c.compileShader(g);if(!c.getShaderParameter(g,c.COMPILE_STATUS))throw h=c.getShaderInfoLog(g),console.error("compile shader fail",h),c.deleteShader(g),Error(`compile shader fail ${h}`);return g};let f,k;try{if(f=e(c.VERTEX_SHADER,a),k=e(c.FRAGMENT_SHADER,b),c.attachShader(d,f),c.attachShader(d,k),c.linkProgram(d),!c.getProgramParameter(d,
c.LINK_STATUS)){const g=c.getProgramInfoLog(d);console.error("link program fail",g);throw Error(`link program fail ${g}`);}}catch(g){throw console.error("shader program create fail",g),g;}finally{f&&c.deleteShader(f),k&&c.deleteShader(k)}return d}bb(){this.X||(this.X=!0,this.C.toggle("flow"),this.Oa=performance.now(),Q(this,"liquifying"),W(this))}Ob(){document.addEventListener("visibilitychange",()=>{(this.isVisible="visible"===document.visibilityState)?this.bb():I(this)});window.addEventListener("resize",
()=>ca(this));window.addEventListener("hashchange",()=>window.location.reload());const a={touchstart:this.wb,pointerdown:this.yb,pointermove:this.xb,pointerup:this.Za,pointerout:this.Za,pointercancel:this.Za};Object.keys(a).forEach(b=>this.A.addEventListener(b,a[b].bind(this)))}wb(a){a.preventDefault()}yb(a){a.preventDefault();const b=a.pointerId;this.A.setPointerCapture(b);a=X(this,a);this.s.set(b,{x:a.x,y:a.y,aa:a.x,ba:a.y,...Y(this)})}xb(a){a.preventDefault();var b=a.pointerId;this.s.has(b)&&(b=
this.s.get(b),a=X(this,a),b.aa=b.x,b.ba=b.y,b.x=a.x,b.y=a.y,b.rx=a.rx,b.ry=a.ry,Z(this))}Za(a){a=a.pointerId;this.s.has(a)&&(this.A.releasePointerCapture(a),this.s.delete(a),Z(this))}get w(){return this.A.width}get v(){return this.A.height}Pb(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b}};}).call(this);
