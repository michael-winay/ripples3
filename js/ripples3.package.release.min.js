/**
 * Nico Pr â€” https://nicopr.fr
 * RIPPLES3 PACKAGE RELEASE v0.0.6
 * 01/02/2025 23:21:48
 */
(function(){const n={"default":{ea:.997,J:.995,R:8,wa:.8,Ea:new Float32Array([.04,.06,.11]),Ca:.02,Aa:.56,xa:.16,xb:.58,qa:.8,ra:.35,Ia:39,va:.6,ta:0,ua:6,za:new Float32Array([.78,.89,1]),vb:.62,oa:.12,ia:.27,pa:.08,L:.023,K:.42,da:.1,ca:.2,na:.25,la:1,ma:.15,ja:.5,ka:3,V:new Float32Array([.35,.65,.45]),S:new Float32Array([-.45,.55,.45]),Ba:5,ya:2,Fa:.2,sa:.16,Da:.05},clear:{ea:.997,J:.994,R:12,wa:.6,Ea:new Float32Array([.01,.02,.03]),Ca:.008,Aa:.02,xa:.89,qa:2.9,ra:.3,Ia:25,va:1.1,ta:0,ua:5,za:new Float32Array([.88,
.96,1]),oa:.1,ia:.15,pa:.07,na:.3,la:.5,ma:.1,ja:.75,ka:2,V:new Float32Array([.45,.85,.5]),S:new Float32Array([-.25,.75,.4]),Ba:9,ya:12,X:.9,W:.22,U:.62,T:.18,Fa:.5,sa:.52,Da:.6,L:.023,K:.57,da:3.2,ca:2.5},thick:{ea:.99,J:.988,R:3.5,wa:.4,Ea:new Float32Array([.05,.07,.12]),Ca:.045,Aa:.42,xa:.32,V:new Float32Array([.32,.58,.42]),S:new Float32Array([-.38,.52,.42]),Ba:12,ya:19,X:.18,W:.12,U:.68,T:.32,qa:.85,ra:1.8,Ia:42,va:2.3,ta:0,ua:.48,za:new Float32Array([.72,.82,.92]),oa:.15,ia:.2,pa:.35,na:.25,
la:.85,ma:.08,ja:.65,ka:2.8,Fa:.45,sa:.48,Da:.1,L:.039,K:.65,da:2.3,ca:2.8},storm:{ea:.998,J:.995,R:12,wa:.62,Ea:new Float32Array([.07,.09,.13]),Ca:.035,Aa:.07,xa:.42,V:new Float32Array([.28,.48,.42]),S:new Float32Array([-.32,.42,.42]),Ba:.6,ya:2.4,X:.1,W:.45,U:.19,T:.48,qa:1.8,ra:4.5,Ia:52,va:3.5,ta:.15,ua:.55,za:new Float32Array([.65,.75,.85]),oa:.3,ia:.85,pa:.28,na:.45,la:.3,ma:.22,ja:.35,ka:4.5,Fa:.13,sa:1.15,Da:.35,L:.032,K:.93,da:3.3,ca:3.6}};function r(a){var b=6*a;a=Math.floor(b);b-=a;const c=1-b;let d,e,f;switch(a%6){case 0:d=1;e=b;f=0;break;case 1:d=c;e=1;f=0;break;case 2:d=0;e=1;f=b;break;case 3:d=0;e=c;f=1;break;case 4:d=b;e=0;f=1;break;case 5:d=1,e=0,f=c}return new Float32Array([d,e,f])}function t(a,b){a=a*Math.PI*2;b*=Math.PI;return new Float32Array([Math.sin(b)*Math.cos(a),Math.cos(b),Math.sin(b)*Math.sin(a)])}
function u(a,b){var c=Object.keys(n);b=a.O+b;var d=c.length-1;a.O=0>b?d:b>d?0:b;c=c[a.O];a.D.innerText=c;c=n[c];v(a,c);a.i.load(c)}
function y(a){const b=Object.entries(a.i.h).map(([c,d])=>Object.hasOwn(a.h,c)?"sunDirection"===c||"secondarySunDirection"===c?null:d instanceof Float32Array?a.h[c].l+"="+JSON.stringify(Array.from(d)):a.h[c].l+"="+JSON.stringify(d):null).filter(Boolean);a.h.X&&a.h.W&&(b.push(`sth=${a.h.X.j}`),b.push(`sph=${a.h.W.j}`));a.h.U&&a.h.T&&(b.push(`lth=${a.h.U.j}`),b.push(`lph=${a.h.T.j}`));navigator.clipboard.writeText(location.origin+location.pathname+"#"+b.join("&")).then(()=>{}).catch(c=>{console.error(c)})}
function z(a){a.N.classList.toggle("pop");a.pop=a.N.classList.contains("pop")}function A(a,b){let c=document.createElement("span");c.tabIndex=0;c.classList.add("action",b.g.replaceAll(" ","-"));c.innerHTML=b.g;a.H.appendChild(c);c.addEventListener("click",()=>{b.C();c.focus()})}function B(a,b){let c=document.createElement("span");c.classList.add("toggle",b.g.replaceAll(" ","-"));b.Kb&&c.classList.add("toggled");c.innerHTML=b.g;a.H.appendChild(c);c.addEventListener("click",()=>{b.C()})}
function C(a,b){let c=document.createElement("div");c.classList.add("prop",b.g.replaceAll(" ","-"));c.addEventListener("pointerdown",e=>{e.preventDefault();let f=e.pointerId;a.A.has(f)||(Object.keys(a.G).forEach(h=>{c.addEventListener(h,a.G[h])}),c.setPointerCapture(f),a.A.set(f,b.g),a.I.set(f,e.pageX),c.classList.add("down"))});var d=document.createElement("div");d.classList.add("valt");d.innerHTML=b.g;c.appendChild(d);d=document.createElement("div");d.classList.add("val");d.innerHTML=b.j;c.appendChild(d);
b.ob=d;b.m?(d=b.m.toLowerCase().replaceAll(" ","-"),(d=a.s.querySelector("."+d))||(d=D(a,b.m)),d.querySelector(".cnt").appendChild(c)):a.s.appendChild(c);a.P.set(b.g,b)}function E(a){const b=a.s.getBoundingClientRect();a.hb={x:Math.round(b.x),y:Math.round(b.y),w:Math.round(b.width),v:Math.round(b.height)}}function F(a){a.B.addEventListener("transitionend",()=>{},{once:!0});a.B.classList.add("up")}
function v(a,b){Array.from(a.P.values()).forEach(c=>{Object.hasOwn(b,c.key)&&(c.j=b[c.key],c.ob.innerText=b[c.key])});b.X&&b.W&&(b.V=t(b.X,b.W));b.U&&b.T&&(b.S=t(b.U,b.T))}
function G(a){const b=window.location.hash.slice(1);if(b.length)try{const h={};var c,d,e,f;b.split("&").map(k=>k.split("=")).forEach(([k,g])=>{const l=Object.keys(a.h).find(p=>a.h[p].l===k);l&&(g=JSON.parse(g),h[l]=Array.isArray(g)?new Float32Array(g):g,"sth"===k&&(c=g),"sph"===k&&(d=g),"lth"===k&&(e=g),"lph"===k&&(f=g))});void 0!==c&&void 0!==d&&(h.V=t(c,d));void 0!==e&&void 0!==f&&(h.S=t(e,f));a.D.innerText="custom";v(a,h);return h}catch(h){console.log("parse params error"),console.error(h)}return{}}
function H(a,b){b.classList.contains("exp")?b.classList.remove("exp"):Array.from(a.s.querySelectorAll(".group")).forEach(c=>c.classList.toggle("exp",c===b))}
function D(a,b){let c=document.createElement("div");c.classList.add("group",b.toLowerCase().replaceAll(" ","-"));a.s.appendChild(c);let d=document.createElement("div");d.classList.add("grp");d.innerHTML=b;c.appendChild(d);b=document.createElement("div");b.classList.add("wrp");c.appendChild(b);let e=document.createElement("div");e.classList.add("cnt");b.appendChild(e);d.addEventListener("click",()=>H(a,c));return c}
class aa{constructor(a){this.i=a;this.pop=!1;this.O=0;this.hb={x:0,y:0,w:0,v:0};this.h={ea:{g:"wave speed",l:"wsp",j:.997,min:.95,max:.999,o:.001,m:"global",exp:"Controls how quickly waves propagate. Higher values = faster waves"},J:{g:"damping",l:"dmp",j:.994,min:.9,max:.999,o:.001,m:"global",exp:"How quickly waves lose energy. Higher values = waves persist longer"},R:{g:"propagation",l:"pgs",j:12,min:2,max:16,o:2,Gb:!0,m:"global",exp:"Distance waves travel per frame. Higher = faster spread"},wa:{g:"refraction",
l:"rft",j:.8,min:0,max:5,o:.01,m:"visual",exp:"Light bending through water. Higher values = more distortion"},xb:{g:"water hue",l:"wth",j:.58,min:0,max:1,o:.01,m:"visual",exp:"Base color of water (0-1 maps to color wheel)",C:b=>{this.i.h.Ea=r(b)}},Ca:{g:"tint",l:"tnt",j:.02,min:0,max:.3,o:.005,m:"visual",exp:"Intensity of water coloration"},Aa:{g:"specular strength",l:"sps",j:.56,min:0,max:5,o:.01,m:"visual",exp:"Intensity of light reflections on water surface"},xa:{g:"roughness",l:"rgs",j:.16,min:0,
max:1,o:.01,m:"visual",exp:"Surface texture. Higher = more diffuse reflections"},qa:{g:"effect",l:"fre",j:.8,min:0,max:30,o:.1,m:"fresnel",exp:"Edge brightness. Higher = stronger edge highlights"},ra:{g:"power",l:"frp",j:2.6,min:.1,max:1,o:.005,m:"fresnel",exp:"Sharpness of edge effect. Higher = more concentrated"},va:{g:"reflection",l:"frr",j:1,min:0,max:5,o:.05,m:"fresnel",exp:"Strength of angle-based reflections"},ta:{g:"blur",l:"blr",j:0,min:0,max:5,o:.01,m:"fresnel",exp:"Softness of reflections"},
ua:{g:"distortion",l:"dst",j:.3,min:0,max:30,o:.1,m:"fresnel",exp:"Wave-based reflection warping"},vb:{g:"sky hue",l:"skh",j:.62,min:0,max:3,o:.01,m:"world",exp:"Color of environmental reflection (0-1 maps to color wheel)",C:b=>{this.i.h.za=r(b)}},oa:{g:"depth",l:"dpt",j:4,min:0,max:10,o:.01,m:"world",exp:"Simulated water depth effect"},ia:{g:"scatter",l:"sct",j:.72,min:0,max:1,o:.01,m:"world",exp:"Atmospheric light scattering in water"},pa:{g:"environment",l:"env",j:.5,min:0,max:5,o:.01,m:"world",
exp:"Strength of environmental reflections"},L:{g:"radius",l:"trd",j:.017,min:.005,max:.1,o:.001,m:"touch",exp:"Size of interaction area"},K:{g:"impact",l:"tmp",j:0,min:.01,max:2,o:.01,m:"touch",exp:"Initial strength of touch disturbance"},da:{g:"trail",l:"ttr",j:0,min:0,max:5,o:.05,m:"touch",exp:"Strength of continuous touch effect"},ca:{g:"spread",l:"tsp",j:3.2,min:0,max:5,o:.05,m:"touch",exp:"How widely touch effect spreads"},na:{g:"strength",l:"css",j:.25,min:0,max:1,o:.01,m:"caustic",exp:"Intensity of underwater light patterns"},
la:{g:"scale",l:"csc",j:1,min:.5,max:3,o:.1,m:"caustic",exp:"Size of caustic patterns"},ma:{g:"speed",l:"csp",j:.15,min:0,max:2,o:.01,m:"caustic",exp:"Animation speed of caustics"},ja:{g:"brightness",l:"csb",j:.5,min:0,max:2,o:.01,m:"caustic",exp:"Overall brightness of caustic effects"},ka:{g:"detail",l:"csd",j:2,min:0,max:5,o:.05,m:"caustic",exp:"Complexity of caustic patterns"},Ba:{g:"sun",l:"sun",j:.3,min:0,max:50,o:.1,m:"sunlight",exp:"Primary light source intensity"},X:{g:"sun angle",l:"sth",
j:.1,min:0,max:1,o:.01,m:"sunlight",exp:"Horizontal angle of sun (0-1 = 0-360\u00b0)",C:()=>{this.i.h.V=t(this.h.X,this.h.W)}},W:{g:"sun height",l:"sph",j:.35,min:0,max:1,o:.01,m:"sunlight",exp:"Vertical angle of sun (0 = up, 1 = down)",C:()=>{this.i.h.V=t(this.h.X,this.h.W)}},ya:{g:"light",l:"lht",j:.16,min:0,max:50,o:.1,m:"sunlight",exp:"Secondary light source intensity"},U:{g:"light angle",l:"lth",j:.65,min:0,max:1,o:.01,m:"sunlight",exp:"Horizontal angle of secondary light",C:()=>{this.i.h.S=
t(this.h.U,this.h.T)}},T:{g:"light height",l:"lph",j:.3,min:0,max:1,o:.01,m:"sunlight",exp:"Vertical angle of secondary light",C:()=>{this.i.h.S=t(this.h.U,this.h.T)}},Fa:{g:"waves",l:"rfs",j:.5,min:0,max:5,o:.01,m:"reflect",exp:"Strength of wave-based reflections"},sa:{g:"mirror",l:"rfm",j:.16,min:0,max:15,o:.05,m:"reflect",exp:"Strength of mirror-like reflections"},Da:{g:"velocity",l:"rfv",j:.05,min:0,max:10,o:.05,m:"reflect",exp:"How much wave motion affects reflections"}};this.N=document.createElement("div");
this.N.classList.add("params");document.body.appendChild(this.N);this.B=document.createElement("div");this.B.classList.add("gear");this.N.appendChild(this.B);this.s=document.createElement("div");this.s.classList.add("pwrp");this.N.appendChild(this.s);this.H=document.createElement("div");this.H.classList.add("switch");this.s.appendChild(this.H);this.F=document.createElement("div");this.F.classList.add("preset");this.s.appendChild(this.F);a=document.createElement("div");a.classList.add("preprev");a.innerText=
"<";this.F.appendChild(a);a.addEventListener("click",()=>u(this,-1));this.D=document.createElement("div");this.D.classList.add("prename");this.D.innerText="default";this.F.appendChild(this.D);a=document.createElement("div");a.classList.add("prenext");a.innerHTML=">";this.F.appendChild(a);a.addEventListener("click",()=>u(this,1));this.Y={close:{g:"about",M:"cmd",C:()=>{window.location="https://post.nicopr.fr/liquid-code/"}},toggle:{g:"flow",M:"swp",C:()=>{var b=this.i;b.Z?I(b):b.Va()},Kb:!0},reset:{g:"reset",
M:"cmd",C:()=>J(this.i)},$b:{g:"upscl",M:"cmd",C:()=>{var b=this.i;K(b,b.u+.5)}},Xb:{g:"copy",M:"cmd",C:()=>y(this)},Vb:{g:"&nbsp;".repeat(5),M:"cmd",C:()=>{}},Wb:{g:"point",M:"swp",C:()=>{var b=this.i;b.G?b.G&&(b.G=!1,b.A.toggle("point",b.G)):ba(b)}},Yb:{g:"rain",M:"swp",C:()=>{var b=this.i;b.Oa?(b.Oa=!1,b.A.toggle("rain",!1)):(b.Oa=!0,b.ab=0,b.Ka=new Set,L(b),b.A.toggle("rain"))}},Zb:{g:"swirl",M:"cmd",C:()=>{z(this);setTimeout(()=>{var b=this.i;for(let c=0;3>c;c++)ca(b,b.w/2,b.v/2,.3*Math.min(b.w,
b.v),2*Math.PI/3*c,b.yb)},200)}}};this.A=new Map;this.I=new Map;this.P=new Map;this.ha=this.ga.bind(this);this.Z=this.fa.bind(this);this.G={pointermove:this.ha,pointerup:this.Z,pointerleave:this.Z};Object.keys(this.Y).forEach(b=>{b=this.Y[b];"cmd"===b.M?A(this,b):"swp"===b.M&&B(this,b)});Object.keys(this.h).forEach(b=>{const c=this.h[b];c.key=b;c.j=this.i.h[b]||c.j;c.C=d=>{this.i.h[b]=d};C(this,c)});this.B.addEventListener("click",()=>z(this));this.N.addEventListener("transitionend",()=>E(this))}toggle(a,
b=!0){this.s.querySelector("."+a).classList.toggle("toggled",b)}ga(a){a.preventDefault();let b=a.pointerId;if(this.A.has(b)){let e=Math.round((a.pageX-this.I.get(b))/3);if(0!=e){var c=this.A.get(b);c=this.P.get(c);var d=String(c.o).match(/\.(\d+)$/);d=Math.pow(10,d?d[1].length:0);c.j=Math.round(Math.min(Math.max(c.min,c.j+e*c.o),c.max)*d)/d;this.I.set(b,a.pageX);c.Gb&&(J(this.i),this.i.Ta());c.C(c.j);a=String(c.o).match(/\.(\d+)$/);c.ob.innerHTML=c.j.toFixed(a?a[1].length:0)}}}fa(a){a.preventDefault();
a=a.pointerId;if(this.A.has(a)){let b=this.A.get(a),c=document.querySelector(".params ."+b.replaceAll(" ","-"));c.releasePointerCapture(a);Object.keys(this.G).forEach(d=>{c.removeEventListener(d,this.G[d])});c.classList.remove("down");this.A.delete(a);this.I.delete(a)}}};const M=a=>{console.error(a);const b=document.createElement("div");b.classList.add("err");b.innerHTML="<div>liquify fail</div><br/>"+a;document.body.appendChild(b)};window.addEventListener("load",()=>{window.addEventListener("error",a=>{M(a.error);return!1});window.addEventListener("unhandledrejection",a=>{M(a.reason);return!1});try{const a=new da,b=new aa(a);ea(a,b,G(b)).then(()=>{setTimeout(()=>{},500+Math.round(500*Math.random()))}).catch(c=>M(c))}catch(a){M(a)}});
function J(a){const b=a.i,c=new Float32Array(a.w*a.v*4);for(let d=0;d<c.length;d+=4)c[d]=0,c[d+1]=0,c[d+2]=0,c[d+3]=1;[a.D,a.F].forEach(d=>{b.bindTexture(b.TEXTURE_2D,d);b.texImage2D(b.TEXTURE_2D,0,b.RGBA32F,a.w,a.v,0,b.RGBA,b.FLOAT,c)});a.P=a.I;a.Y=a.D;a.H=a.F}
function ea(a,b=null,c={}){a.A=b;a.h={...a.h,...c};a.Na=document.querySelector("#fps");return[a.Sb,a.Tb,a.Qb,a.Lb,a.Pb,a.Hb,a.sb,a.ub,a.Ob,a.tb,a.Ta,a.Ub,a.Va].map(d=>d.bind(a)).reduce((d,e)=>d.then(()=>e()),Promise.resolve()).then(()=>N(a,1).then(()=>{console.log("liquified");F(a.A)})).catch(d=>{throw d;})}function O(a){a.eb=window.innerWidth;a.cb=window.innerHeight;a.Sa=Math.max(a.eb,a.cb)/960;a.Ha=2/a.u*a.Ab}function P(a){a.O&&(a.O=!1,a.La=0)}
function Q(a,b){window.requestAnimationFrame(()=>{a.Na.textContent=b})}function R(a){a.O||(a.O=!0,a.qb=a.Pa+1E3)}function N(a,b){return new Promise(c=>{a.B.addEventListener("transitionend",()=>c(),{once:!0});a.B.style.opacity=b})}function S(a){return new Promise(b=>{const c=new Image;c.addEventListener("load",()=>b(c));c.addEventListener("error",()=>{throw Error("image load error "+a);});c.crossOrigin="Anonymous";c.src=a})}
async function T(a){return await (new Response((new Response(Uint8Array.from(atob(a),b=>b.charCodeAt(0)))).body.pipeThrough(new DecompressionStream("gzip")))).text()}
function U(a){const b=a.i,c=b.createTexture();b.bindTexture(b.TEXTURE_2D,c);b.texImage2D(b.TEXTURE_2D,0,b.RGBA32F,a.w,a.v,0,b.RGBA,b.FLOAT,null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);if(b.getError()!==b.NO_ERROR)throw Error("create water texture fail");return c}
function fa(a){const b=a.i;[a.D,a.F].forEach(c=>{b.bindTexture(b.TEXTURE_2D,c);b.texImage2D(b.TEXTURE_2D,0,b.RGBA32F,a.w,a.v,0,b.RGBA,b.FLOAT,null)});[a.I,a.Ya].forEach(c=>{b.bindFramebuffer(b.FRAMEBUFFER,c);if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw Error("incomplete resized framebuffer");});b.bindFramebuffer(b.FRAMEBUFFER,null)}
function ha(a){if(a.image?.complete&&a.image.naturalWidth){var b=a.i,c=document.createElement("canvas"),d=c.getContext("2d",{alpha:!1});c.width=a.w;c.height=a.v;d.fillStyle="#000000";d.fillRect(0,0,a.w,a.v);var e=a.image.naturalWidth,f=a.image.naturalHeight,h=a.w/a.v;if(h>e/f){var k=e;var g=Math.round(e/h);e=0;f=Math.round((f-g)/2)}else g=f,k=Math.round(f*h),f=0,e=Math.round((e-k)/2);d.drawImage(a.image,e,f,k,g,0,0,a.w,a.v);a.kb.forEach(l=>{if(l.pb?.complete){const {x:p,y:w,w:m,v:x}=l.c();d.globalAlpha=
.55;d.shadowColor="#000000";d.shadowBlur=16;d.drawImage(l.pb,p,w,m,x)}});b.bindTexture(b.TEXTURE_2D,a.Ga);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,c);d.clearRect(0,0,a.w,a.v);c.width=c.height=0;c=null}}function ia(a){P(a);a.A.N.classList.toggle("msk",!0);N(a,0).then(()=>{E(a.A);V(a);N(a,1);a.A.N.classList.toggle("msk",!1);R(a)})}function V(a){O(a);a.sb();a.Ta();a.ub();a.tb()}
function ja(a){const b=a.i,c=a.ga,d=a.h;b.uniform2f(c.gb,a.w,a.v);b.uniform1f(c.time,a.Ja);b.uniform1f(c.u,a.u);Object.keys(d).filter(e=>c[e]&&d[e]instanceof Float32Array).forEach(e=>b.uniform3fv(c[e],d[e]));Object.keys(d).filter(e=>c[e]&&"number"===typeof d[e]).forEach(e=>b.uniform1f(c[e],d[e]))}function I(a){a.Z&&(a.Z=!1,cancelAnimationFrame(a.jb),P(a),a.Na.textContent="x"+a.u.toString()+" --",a.A.toggle("flow",!1))}
function W(a){a.jb=requestAnimationFrame(b=>{if(!a.i||a.i.isContextLost())throw I(a),Error("webgl context lost");a.Ja+=a.Ha;var c=a.i,d=a.bb;c.useProgram(a.fa);c.bindFramebuffer(c.FRAMEBUFFER,a.P);c.bindBuffer(c.ARRAY_BUFFER,a.Ra);var e=c.getAttribLocation(a.fa,"position");c.enableVertexAttribArray(e);c.vertexAttribPointer(e,2,c.FLOAT,!1,0,0);c.uniform2f(d.gb,a.w,a.v);c.uniform1f(d.u,a.u);c.uniform1f(d.Sa,a.Sa);c.uniform1f(d.Ha,a.Ha);c.uniform1f(d.time,a.Ja);c.uniform1f(d.ea,a.h.ea);c.uniform1f(d.J,
a.h.J);c.uniform1f(d.R,a.rb);e=Array.from(a.s.values());const f=Math.min(e.length,10);a.ba.fill(0);const h=a.i,k=a.bb;for(let g=0;g<f;g++){const l=e[g];a.ba[2*g]=l.x;a.ba[2*g+1]=l.y;a.ba[2*(g+f)]=l.$;a.ba[2*(g+f)+1]=l.aa;h.uniform2f(k.touches[g].position,l.x,l.y);h.uniform1f(k.touches[g].Fb,l.L);h.uniform1f(k.touches[g].J,l.Ua);h.uniform1f(k.touches[g].Jb,l.K);h.uniform1f(k.touches[g].Nb,l.da);h.uniform1f(k.touches[g].Ib,l.ca);h.uniform1f(k.touches[g].angle,l.wb)}h.uniform2fv(k.ba,a.ba);h.uniform1i(k.Mb,
f);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,a.H);c.uniform1i(d.fb,0);c.drawArrays(c.TRIANGLE_STRIP,0,4);[a.P,a.Y,a.H]=[a.P===a.I?a.Ya:a.I,a.Y===a.D?a.F:a.D,a.H===a.D?a.F:a.D];c=a.i;c.useProgram(a.Qa);c.bindFramebuffer(c.FRAMEBUFFER,null);c.clearColor(0,0,0,1);c.clear(c.COLOR_BUFFER_BIT);c.bindBuffer(c.ARRAY_BUFFER,a.Ra);d=c.getAttribLocation(a.Qa,"position");c.enableVertexAttribArray(d);c.vertexAttribPointer(d,2,c.FLOAT,!1,0,0);ja(a);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,
a.Y);c.uniform1i(a.ga.Rb,0);c.activeTexture(c.TEXTURE1);c.bindTexture(c.TEXTURE_2D,a.Ga);c.uniform1i(a.ga.Ga,1);c.activeTexture(c.TEXTURE2);c.bindTexture(c.TEXTURE_2D,a.H);c.uniform1i(a.ga.fb,2);c.drawArrays(c.TRIANGLE_STRIP,0,4);d=c.getError();if(d!==c.NO_ERROR)throw Error("render step error "+d);d=c.checkFramebufferStatus(c.FRAMEBUFFER);if(d!==c.FRAMEBUFFER_COMPLETE)throw Error("incomplete framebuffer "+d);ka(a,b);W(a)})}
function ka(a,b){var c=b-a.Pa;a.Pa=b;!a.O||b<a.qb||(a.Ma[a.Xa]=c,a.Xa=(a.Xa+1)%a.Ma.length,c=a.Ma.reduce((d,e)=>d+e)/a.Ma.length,c=Math.round(1E3/c),c!==a.La&&(a.Na.textContent="x"+a.u.toString()+" "+c.toString().padStart(2,"0")),a.La=c,1E3<=b-a.nb&&(a.nb=b,a.Wa++,3<=a.Wa&&(55>a.La?la(a):a.u<a.ib&&a.u<a.ha&&K(a,a.u+.5))))}function la(a){a.ib=a.u-.5;K(a,a.u-.5)}function K(a,b){b=Math.max(Math.min(a.ha,b),1);b!=a.u&&(P(a),Q(a,(b>a.u?"up":"down")+"scale"),a.Wa=0,a.u=Math.round(2*b)/2,V(a),R(a))}
function X(a,b){const c=b.clientX;b=b.clientY;return{x:c*a.u,y:a.v-b*a.u,rx:c,ry:b}}function Y(a){return{L:a.h.L,Ua:a.h.Ua,K:a.h.K,da:a.h.da,ca:a.h.ca,wb:a.h.wb}}function Z(a){if(a.A.pop){const b=Array.from(a.s.values()).some(c=>{var d=c.rx;c=c.ry;var e=a.A.hb;return d>=e.x&&d<=e.x+e.w&&c>=e.y&&c<=e.y+e.v});b!==a.$a&&(a.$a=b,clearTimeout(a.lb),a.lb=setTimeout(()=>{a.A.N.classList.toggle("msk",a.$a)},100))}}
function ca(a,b,c,d,e,f){const h=Math.random().toString(36).slice(-6),k=performance.now(),g=b+Math.cos(e)*d,l=c+Math.sin(e)*d,p={x:g,y:l,$:g,aa:l,...Y(a),speed:2.5};a.s.set(h,p);const w=()=>{var m=performance.now()-k;if(1>m/3333){const x=e+.001*m*p.speed;m=f(m,0,1,3333);m=d*(1-m);if(a.s.has(h)){const q=a.s.get(h);q.$=q.x;q.aa=q.y;q.x=b+Math.cos(x)*m;q.y=c+Math.sin(x)*m;requestAnimationFrame(w)}}else a.s.delete(h)};requestAnimationFrame(w)}
function L(a){if(a.Oa){var b=performance.now();256<b-a.ab&&4>a.Ka.size&&8>a.s.size&&(ma(a),a.ab=b);requestAnimationFrame(()=>L(a))}}function ma(a){const b=Math.random()*a.w,c=Math.random()*a.v,d="rain_"+Math.random().toString(36).slice(-6);a.s.set(d+"_impact",{x:b,y:c,$:b,aa:c,...Y(a),L:.01,Ua:.35,K:.1});setTimeout(()=>{a.s.set(d+"_splash",{x:b,y:c,$:b,aa:c,...Y(a),L:.04,Ua:.35,K:.1})},64);a.Ka.add(d);setTimeout(()=>{a.s.delete(d+"_impact");a.s.delete(d+"_splash");a.Ka.delete(d)},72)}
function ba(a){if(!a.G){a.G=!0;var b=0,c={x:a.w/2,y:a.v/2,$:a.w/2,aa:a.v/2,speed:.01,scale:.5,...Y(a)};a.s.set("auto",c);var d=()=>{a.G?(b+=c.speed,c.$=c.x,c.aa=c.y,c.x=a.w*(.5+c.scale*Math.sin(b)),c.y=a.v*(.5+c.scale*Math.cos(1.5*b)),window.requestAnimationFrame(d)):a.s.delete("auto")};d();a.A.toggle("point")}}
class da{constructor(){this.u=this.ha=2;this.O=!1;this.Wa=0;this.ib=this.ha;this.Bb=1E3/60;this.Ab=this.Bb/1E3;this.Sa=this.eb=this.cb=0;O(this);this.h={ea:.997,J:.992,R:8,wa:.8,Ea:new Float32Array([.04,.06,.11]),Ca:.02,Aa:.56,xa:.16,xb:.58,qa:.8,ra:.35,Ia:39,va:.6,ta:0,ua:6,za:new Float32Array([.78,.89,1]),vb:.62,oa:.12,ia:.27,pa:.08,L:.023,K:.42,da:.1,ca:.2,na:.25,la:1,ma:.15,ja:.5,ka:3,V:new Float32Array([.35,.65,.45]),S:new Float32Array([-.45,.55,.45]),Ba:5,ya:2,Fa:.2,sa:.16,Da:.05};this.A=this.lb=
this.image=this.B=this.i=this.Ra=this.fa=this.bb=this.Qa=this.ga=this.Y=this.H=this.Ga=this.D=this.F=this.P=this.I=this.Ya=null;this.jb=-1;this.$a=!1;this.zb=new Float32Array([-1,-1,1,-1,-1,1,1,1]);this.ba=new Float32Array(20);this.rb=this.h.R;this.La=0;this.Ma=Array(30).fill(16.67);this.qb=this.nb=this.Pa=this.Xa=0;this.Z=!1;this.isVisible=!0;this.Oa=this.G=this.mb=!1;this.ab=0;this.Ka=null;this.s=new Map;this.Ja=this.Ha=0;this.kb=[];this.Na=null;this.B=document.createElement("canvas");this.B.style.opacity=
0;document.body.appendChild(this.B)}load(a){P(this);Q(this,"load params");J(this);this.h={...this.h,...a};this.Ta();R(this)}async Sb(){this.image=await S("assets/img.webp")}async Tb(){this.kb.push({pb:await S("assets/github-mark-white.png"),c:()=>({x:this.w-42*this.u,y:6*this.u,w:36*this.u,v:36*this.u})})}Qb(){this.i=this.B.getContext("webgl2",{alpha:!1,antialias:!1,depth:!1,stencil:!1,powerPreference:"high-performance",preserveDrawingBuffer:!1});if(!this.i)throw Error("webgl2 not supported");if(!this.i.getExtension("EXT_color_buffer_float"))throw Error("ext_color_buffer_float not supported");
this.i.getExtension("OES_texture_float_linear");const a=this.i.getError();if(a!==this.i.NO_ERROR)throw Error("webgl init error "+a);}async Lb(){const a=await T("H4sIAAAAAAAAClMuSy0qzszPUzA2MFBILebKzFMoS002UijIL84syczPs84vLYGIlKRWOOfnF6VYl+VnpijkJmbmaWhWwwRtYeq19Ey19Uyt03PiA6AitmWpySYaMHkdAx1DTetaAIBqaOZ3AAAA"),b=await T("H4sIAAAAAAAACoVUTW+bQBC991cgVYpYvMZgJ20qQg6Ne+vBiqP2EPmwgjGMBCzaD5c04r9XuyyE2JVyY2dn3rw385bPJxASeeNtosgD+akVkKENlFiUrXesOFPJeVSyuq1ArLeJbvDIRe2dIFt7+hEkr7RC3kwXFsDTW6gUe8IaqN6ibCv2ss9YBVTv8S98ZxKo/s1OsG8Bcqq3rG6xKajeCd6yghlEezXBTgw8vRNwQq7lXjEFZ4SeuM7K5zg6THFslAs/cN2oRCqhM+XZyKstarlEK2GgLliOWrqDVAKaQpXuqATDarxqBbA86adOFtL12jHBammJYDNwU9A9cC7yhGtlItfeUbDigVdcJCeOuVczbHzyaq+k0ZYq6JQW4L+XTEck4piUgEWpUlsTdskgCjuoUvPpx2Q1X5Rjr+s0CpMjF76ZEKZRgne3CS4W5HXIYE1RQWq/fSRB+PX2ZvPtNv6ySaSuFx9xW9jWGZe+xSFUYuM+SWDJBRfLJmGX9IZYjZ0/iKJS10EYr2+CdbgcBL7MnEOC0TpO1p+SKeOwtGadP1MddnR+eiFnyucOmc0gR6nSyjrAH5UFM6ClMxweyMr/qOVq8j6h0jyG/NFaLX1nGTyEzoF49E3/u3nuSAzrlmXqonK0ayBrzlUpFbT+vJxGITWYJAhvDP55vfX3fRReXeF9RNzzEHDa8ZHlMy7jA635CX5BNsUOS5fl1mDuf0Izjs6lk9W4HtPb5dzHsLx2rUxoiyJ1+auzcqr4jmOj0v+u4j0DVvGmeDJy0pwr31VS14EYAm8pd1E4DtZO4MfxCJlKoWv95bj9AWD5VhSMWJOq1cU8h3/EIoyimJBkWNriYmu2ZzDrHLjZBOEm6fvevrehOOn76a9hXve1L3VN3VuJaEyS/h+jh5Pl4gUAAA=="),
c=await T("H4sIAAAAAAAACpVWS3PbNhC+91dwphcAhGBRttp4EB5qK57mkE7GcpMzSoESJhTBgoBMJqP/3gHAB6hH655ILLmLb1/f7s8Hrmohy+h2Po94/VOleCacYCe2uyrKC8k0PZXWbF8VXC1W1JQil2ofHXi2iMwzr2VhtJDl8MEZiMyL2HNsVqKuCtauM1bw4Y/BWGS+Ms3V71xsdxqbB5Z92yppys0Lb7RRHJvPih+ENPVaM83Du28jszblSiie2duxWfNMlhum2lB8Cmptyo+l5mUtdBuoBLJnnis21fW3OaQvotTnjpZ6rRUvt3qHzbrimSmYGiXP0mx3Ja9rbJ4Ur0tefMhznunh+Fm+cjVqdsdnnhfeie63ULQStZbqAsr1t/ZRFlKdglzxSu+eWKalwuY3vZd1teNKZOuMaW2v+1AePrEqCMQjM7UW2ehHL7CpHE8V55vh9KBsIr2vnWjFNRMFNl/ZgY/4R6ufhFJSXfryhRcyE7oNAtHhHyUPhVFUlL4YNW8epVQbKo22krsoV2zrw+Gis+X6D6n2rAC+eA/YPSvR8AL+cBobplmqffWBaXUeIPXBLJ2NHmiakJj9VQOrSZqZe7QQLQhVXBtVdr+L79zeegvARetZwfYVMIeZRQQcItLgOcRzghMCIWlm/6oXX9WDaIoXTXoSvwXOHHvD7f+Ec0nvP+AkENKjS5YnCZtgxTdjxofU+VwothGmPs3jbZTZrKcu4PM+b1pqVqRzQnOpgCh11KSzhDbv04Q2cQx7aWulrZW2cezMLSKZ5zXX6dQ9ZxU00EMBLYTIw0EOSecz9bqkTRMy6987RK8uavZD4YLhnAMNbiG8WRDqnIjHcjznR28Pkqb9jrwx6ryM0+507IrQmbpx3+jRX77lehrW265UsXsvrP5KKH86CP5qD1710LUm/OHPdcWzldTpnjVgIzXo7IyV3xuLOzvQVgTsOgRU8hV0JvBi+QuB6I6gq8yAFiQONabEiUBCZiPnQoiA7c4BMUoWJCbvILrCSCghS4jOaNyajaeGrhIUuiO2iKXYRHsmStDVkCuK1GU4gTfh5AwjnJ7QxRzPXVM4dtq5pK6uclTPgH3F+//TUY00uHegk86Cjy0NqiAd2bI369sZ0t1QtrypAJglJPYiFM4ZiC4Mmh5Z5qdDOid44yaEa/90OjVQ0jWr1xFpQqh4ny4IFUNndobqP7+kPUw0GVVIxN4h0rTo8gj15j2OJ8X/TgNISNDuijitRQnG+0iDRpXY7TtoMhaRgOhEpX2DCkjIjYD02IeoeyKyjMnSZygXJSvcYEv3ogHXqNLTVR+WIAwgWHNOqpose7I+nbMXWmBJYFcTeNyP8GQj6iuDLCENM207OCGzE8bo6cGyw3Q/gmi6PdEgBt7PURC7zkkwuf8Vk/sFRFOqO2OnySYJexA4aPVwb/TWyf07TO7vcfIG65c208vXnC2ksc3vsNVh7xgMewai090NheV7vkdOowNRX1+nGx863+ocufqE9lVChx3LUttdkAWcQHr8BxvpwntuDAAA");
this.fa=this.createProgram(a,b);this.Qa=this.createProgram(a,c)}Hb(){this.Ra=this.i.createBuffer();this.i.bindBuffer(this.i.ARRAY_BUFFER,this.Ra);this.i.bufferData(this.i.ARRAY_BUFFER,this.zb,this.i.STATIC_DRAW)}sb(){const a=Math.round(this.cb*this.u);this.B.width=Math.round(this.eb*this.u);this.B.height=a}ub(){this.i.viewport(0,0,this.w,this.v)}Ta(){this.rb=Math.round(this.h.R*this.u/2)}Ob(){const a=this.i;this.D=U(this);this.F=U(this);const b=this.i,c=b.createTexture();b.bindTexture(b.TEXTURE_2D,
c);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,this.w,this.v,0,b.RGBA,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);this.Ga=c;this.I=this.createFramebuffer(this.D);this.Ya=this.createFramebuffer(this.F);this.P=this.I;this.Y=this.D;this.H=this.F;a.bindFramebuffer(a.FRAMEBUFFER,null);a.bindTexture(a.TEXTURE_2D,
null)}createFramebuffer(a){const b=this.i,c=b.createFramebuffer();b.bindFramebuffer(b.FRAMEBUFFER,c);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,a,0);a=b.checkFramebufferStatus(b.FRAMEBUFFER);if(a!==b.FRAMEBUFFER_COMPLETE)throw Error(`incomplete framebuffer ${a}`);return c}tb(){fa(this);ha(this)}Pb(){const a=(b,c)=>Object.keys(c).reduce((d,e)=>({...d,[e]:this.i.getUniformLocation(b,`u${c[e]}`)}),{});this.bb={...a(this.fa,{gb:"Resolution",u:"DisplayScale",Sa:"SizeBase",Ha:"DeltaTime",
time:"Time",ea:"WaveSpeed",J:"Damping",R:"PropagationSpeed",fb:"PreviousState",ba:"Touch",Mb:"TouchCount"}),touches:Array(10).fill({}).map((b,c)=>{b=`TouchParams[${c}].`;return a(this.fa,{position:`${b}position`,Fb:`${b}radius`,J:`${b}damping`,Jb:`${b}strength`,Nb:`${b}trail`,Ib:`${b}spread`,angle:`${b}angle`})})};this.ga=a(this.Qa,{gb:"Resolution",time:"Time",u:"DisplayScale",fb:"PreviousState",Rb:"WaterHeight",Ga:"BackgroundTexture",V:"SunDirection",S:"SecondarySunDirection",Ba:"SunIntensity",ya:"SecondaryIntensity",
wa:"Refraction",Ea:"WaterTint",Ca:"TintStrength",Aa:"SpecularStrength",xa:"Roughness",qa:"FresnelEffect",ra:"FresnelPower",Ia:"SpecularPower",za:"SkyColor",oa:"DepthFactor",ia:"AtmosphericScatter",pa:"EnvMapIntensity",va:"ReflectionFresnel",ta:"ReflectionBlur",ua:"ReflectionDistortion",na:"CausticStrength",la:"CausticScale",ma:"CausticSpeed",ja:"CausticBrightness",ka:"CausticDetail",Fa:"WaveReflectionStrength",sa:"MirrorReflectionStrength",Da:"VelocityReflectionFactor"})}createProgram(a,b){const c=
this.i,d=c.createProgram(),e=(k,g)=>{k=c.createShader(k);c.shaderSource(k,g);c.compileShader(k);if(!c.getShaderParameter(k,c.COMPILE_STATUS))throw g=c.getShaderInfoLog(k),c.deleteShader(k),Error(`compile shader fail ${g}`);return k};let f,h;try{if(f=e(c.VERTEX_SHADER,a),h=e(c.FRAGMENT_SHADER,b),c.attachShader(d,f),c.attachShader(d,h),c.linkProgram(d),!c.getProgramParameter(d,c.LINK_STATUS))throw Error(`link program fail ${c.getProgramInfoLog(d)}`);}catch(k){throw k;}finally{f&&c.deleteShader(f),h&&
c.deleteShader(h)}return d}Va(){this.Z||(Q(this,"liquify"),this.Z=!0,this.A.toggle("flow"),this.Pa=performance.now(),R(this),W(this))}Ub(){document.addEventListener("visibilitychange",()=>{(this.isVisible="visible"===document.visibilityState)?this.Va():I(this)});window.addEventListener("resize",()=>{ia(this)});window.addEventListener("hashchange",()=>window.location.reload());const a={touchstart:this.Cb,pointerdown:this.Eb,pointermove:this.Db,pointerup:this.Za,pointerout:this.Za,pointercancel:this.Za};
Object.keys(a).forEach(b=>this.B.addEventListener(b,a[b].bind(this)))}Cb(a){a.preventDefault()}Eb(a){a.preventDefault();const b=a.pointerId;this.mb||(this.mb=!0);this.B.setPointerCapture(b);a=X(this,a);this.s.set(b,{x:a.x,y:a.y,$:a.x,aa:a.y,...Y(this)})}Db(a){a.preventDefault();var b=a.pointerId;this.s.has(b)&&(b=this.s.get(b),a=X(this,a),b.$=b.x,b.aa=b.y,b.x=a.x,b.y=a.y,b.rx=a.rx,b.ry=a.ry,Z(this))}Za(a){a=a.pointerId;this.s.has(a)&&(this.B.releasePointerCapture(a),this.s.delete(a),Z(this))}get w(){return this.B.width}get v(){return this.B.height}yb(a,
b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b}};}).call(this);
